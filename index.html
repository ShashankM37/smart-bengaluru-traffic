<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Smart Bengaluru Traffic</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

<style>
:root{
  --primary:#1a237e;
  --accent:#ff6f00;
}
*{box-sizing:border-box}
body{
  margin:0;
  font-family:system-ui,Arial;
  background:linear-gradient(180deg,#eef2ff,#ffffff);
}
header{
  background:linear-gradient(90deg,#1a237e,#3949ab);
  color:#fff;
  padding:16px;
  text-align:center;
  font-size:22px;
  font-weight:700;
}
.screen{display:none;padding:16px}
.active{display:block}
.card{
  background:#fff;
  padding:16px;
  border-radius:18px;
  box-shadow:0 12px 30px rgba(0,0,0,.15);
  margin-bottom:14px;
  animation:fade .5s ease;
}
@keyframes fade{
  from{opacity:0;transform:translateY(10px)}
  to{opacity:1;transform:none}
}
.hero{
  background:linear-gradient(135deg,#1a237e,#5c6bc0);
  color:#fff;
  padding:30px;
  border-radius:24px;
  text-align:center;
}
.hero span{
  display:inline-block;
  margin-top:12px;
  padding:8px 18px;
  background:#ff6f00;
  border-radius:999px;
  animation:pulse 2s infinite;
}
@keyframes pulse{
  0%{box-shadow:0 0 0 0 rgba(255,111,0,.6)}
  70%{box-shadow:0 0 0 18px rgba(255,111,0,0)}
}
.grid{
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:14px;
}
.tile{
  background:linear-gradient(135deg,#303f9f,#7986cb);
  color:#fff;
  padding:22px;
  border-radius:20px;
  text-align:center;
  font-weight:600;
  cursor:pointer;
}
button{
  width:100%;
  padding:14px;
  border:none;
  border-radius:14px;
  background:#303f9f;
  color:#fff;
  font-size:16px;
}
.back{background:#555}
input,select,textarea{
  width:100%;
  padding:10px;
  margin-bottom:8px;
  border-radius:10px;
  border:1px solid #ccc;
}
iframe{
  width:100%;
  height:360px;
  border-radius:16px;
  border:none;
}
ul{padding-left:16px}
</style>
</head>

<body>

<header>üö¶ Smart Bengaluru Traffic</header>

<!-- HOME -->
<div id="home" class="screen active">
  <div class="hero">
    <h1>Move Smart. Beat Traffic.</h1>
    <p>Citizen-powered live traffic & carpooling</p>
    <span>SMART CITY MODE</span>
  </div>

  <div class="card">
    <div class="grid">
      <div class="tile" onclick="openScreen('map')">üó∫ Live Map</div>
      <div class="tile" onclick="openScreen('road')">üöß Roadblocks</div>
      <div class="tile" onclick="openScreen('carpool')">üöó Carpool</div>
      <div class="tile" onclick="openScreen('students')">üéì Students</div>
      <div class="tile" onclick="openScreen('workers')">üë∑ Workers</div>
      <div class="tile" onclick="openScreen('help')">üÜò Emergency</div>
    </div>
  </div>
</div>

<!-- MAP -->
<div id="map" class="screen">
<div class="card">
<h2>Live Traffic Map</h2>
<iframe src="https://www.google.com/maps?q=bangalore&output=embed&layer=t"></iframe>
<button class="back" onclick="openScreen('home')">Back</button>
</div>
</div>

<!-- ROADBLOCK -->
<div id="road" class="screen">
<div class="card">
<h2>Report Roadblock</h2>
<input id="rb_loc" placeholder="Location">
<select id="rb_type">
<option value="">Issue</option>
<option>Accident</option>
<option>Roadblock</option>
<option>Construction</option>
<option>Heavy Traffic</option>
</select>
<textarea id="rb_det" placeholder="Details"></textarea>
<button onclick="submitRoadblock()">Submit</button>
<ul id="rlist"></ul>
<button class="back" onclick="openScreen('home')">Back</button>
</div>
</div>

<!-- CARPOOL -->
<div id="carpool" class="screen">
<div class="card">
<h2>Host Add Ride</h2>
<input id="host_pin" placeholder="Host PIN">
<input id="cf" placeholder="From">
<input id="ct" placeholder="To">
<input id="ctm" placeholder="Time">
<input id="cs" type="number" placeholder="Seats">
<input id="cc" placeholder="Host Contact">
<button onclick="addRide()">Add Ride</button>
</div>

<div class="card">
<h2>Available Rides</h2>
<ul id="rideList"></ul>
<button class="back" onclick="openScreen('home')">Back</button>
</div>
</div>

<!-- STUDENTS -->
<div id="students" class="screen">
<div class="card">
<h2>Student Tips</h2>
<ul>
<li>Travel early</li>
<li>Use Metro</li>
<li>Share rides</li>
</ul>
<button class="back" onclick="openScreen('home')">Back</button>
</div>
</div>

<!-- WORKERS -->
<div id="workers" class="screen">
<div class="card">
<h2>Worker Tips</h2>
<ul>
<li>WFH when possible</li>
<li>Avoid peak hours</li>
<li>Use carpool</li>
</ul>
<button class="back" onclick="openScreen('home')">Back</button>
</div>
</div>

<!-- HELP -->
<div id="help" class="screen">
<div class="card">
<h2>Emergency</h2>
<a href="tel:112">üìû Call 112</a>
<button class="back" onclick="openScreen('home')">Back</button>
</div>
</div>

<script>
function openScreen(id){
  document.querySelectorAll(".screen").forEach(s=>s.classList.remove("active"));
  document.getElementById(id).classList.add("active");
}

// üî• FIREBASE CONFIG (replace with yours)
firebase.initializeApp({
  apiKey: "YOUR_API_KEY",
  authDomain: "YOUR_PROJECT.firebaseapp.com",
  projectId: "YOUR_PROJECT_ID"
});
const db = firebase.firestore();

/* ROADBLOCKS */
function submitRoadblock(){
  db.collection("roadblocks").add({
    location: rb_loc.value,
    type: rb_type.value,
    details: rb_det.value,
    time: new Date().toLocaleString()
  });
}

db.collection("roadblocks").onSnapshot(snap=>{
  rlist.innerHTML="";
  snap.forEach(doc=>{
    const d=doc.data();
    rlist.innerHTML+=`<li><b>${d.type}</b> @ ${d.location}<br>${d.details}<br><small>${d.time}</small></li>`;
  });
});

/* CARPOOL */
function addRide(){
  if(host_pin.value!=="1234"){alert("Invalid PIN");return;}
  db.collection("carpool").add({
    from:cf.value,to:ct.value,time:ctm.value,
    seats:+cs.value,host:cc.value,joiners:[]
  });
}

function joinRide(id,seats,joiners){
  if(seats<=0)return alert("No seats");
  const name=prompt("Name"),phone=prompt("Phone"),pickup=prompt("Pickup");
  db.collection("carpool").doc(id).update({
    seats:seats-1,
    joiners:[...joiners,{name,phone,pickup}]
  });
}

db.collection("carpool").onSnapshot(snap=>{
  rideList.innerHTML="";
  snap.forEach(doc=>{
    const r=doc.data();
    rideList.innerHTML+=`
    <li><b>${r.from} ‚ûù ${r.to}</b><br>
    Time:${r.time}<br>Seats:${r.seats}<br>
    <button onclick="joinRide('${doc.id}',${r.seats},${JSON.stringify(r.joiners)})">Join</button></li>`;
  });
});
</script>

</body>
</html>
